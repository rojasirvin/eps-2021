---
title: "Respuestas a la tarea 1"
summary: " "
weight: 2
type: book
toc: false
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<div id="instrucciones" class="section level2">
<h2>Instrucciones</h2>
<p>La tarea debe entregarse de manera individual, pero se recomienda ampliamente colaborar en grupos de estudio. Las secciones teóricas deben estar desarrolladas en un procesador de textos y enviadas en formato .docx o .pdf. Las secciones prácticas deberán contener archivos de código replicable y archivos de salida en R (o similares, en caso de usar otro software) para considerarse completas. Las tareas deben entregarse antes de la fecha límite a través de Teams. Puede crear una carpeta comprimida que contenga todos sus archivos y subir esta carpeta en Teams. Recuerde que en Teams debe asegurarse de que los archivos se han subido correctamente.</p>
</div>
<div id="pregunta-1" class="section level2">
<h2>Pregunta 1</h2>
<p>Suponga que para un experimento en un laboratorio se asignó a un grupo estudiantes a un brazo de tratamiento o a uno de control. Antes de comenzar el experimento se recolectaron una serie de características <span class="math inline">\(x_{ji}\)</span>, <span class="math inline">\(j=1,\ldots 5\)</span>, de cada estudiante. Se busca medir el efecto del tratamiento sobre una variable de resultados <span class="math inline">\(y_i\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li><p>[5 puntos] El investigador A quedó a cargo de comprobar el balance de la asignación del tratamiento y le reporta lo siguiente:</p>
<p><em>Para verificar que la aleatorización fue exitosa, tomé la serie de variables pre-intervención y la dummy de asignación al tratamiento <span class="math inline">\(T_i\)</span> para correr la siguiente regresión:</em>
<span class="math display">\[T_i=\alpha+\sum_{j=1}^{5}x_{ji}&#39;\beta +\varepsilon_i\]</span></p>
<p><em>Después realicé una prueba <span class="math inline">\(F\)</span> de significancia conjunta sobre los coeficientes <span class="math inline">\(\beta_j\)</span> que resultó tener un valor <span class="math inline">\(p\)</span> de 0.003.</em></p>
<p>Explique qué interpretación tiene la prueba realizada por el investigador A y qué se esperaría de haberse logrado una aleatorización exitosa del tratamiento?</p>
<p><em>Si la integridad del diseño se mantuvo durante el experimento, se esperaría que las características observables no predijeran el estado de tratamiento. En otras palabras, esperaríamos que los coeficientes en su conjunto no fueran significativos. Es decir, <span class="math inline">\(H_0: \beta_1=\beta_2=\ldots=\beta_k=0\)</span>. Un estadístico <span class="math inline">\(F\)</span> debería entonces tener una probabilidad mayor al valor de <span class="math inline">\(\alpha\)</span> escogido para el estudio. Claramente, en este caso, el valor <span class="math inline">\(p\)</span> está muy por debajo de cualquier valor de significancia usado normalmente en economía.</em></p></li>
<li><p>[5 puntos] ¿Qué concluye a partir de lo que le reporta el investigador A?</p>
<p><em>Por tanto, rechazamos la hipótesis de que las características no predicen el tratamiento. Concluimos que existe evidencia de que el diseño del experimento se vio comprometido.</em></p></li>
<li><p>[5 puntos] El investigador B le reporta lo siguiente:</p>
<p><em>Yo realicé un análisis adicional para determinar el balance en la asignación del tratamiento. Para cada una de las características <span class="math inline">\(x_{ji}\)</span> corrí la siguiente regresión:</em>
<span class="math display">\[x_{ji}=\gamma+\pi T_i+u_i\]</span>
<em>A continuación, le reporto una tabla con los valores p asociados al coeficiente estimado de <span class="math inline">\(\pi\)</span> en cada una de las 5 regresiones.</em></p>
<table>
<thead>
<tr class="header">
<th><strong>Característica</strong></th>
<th><strong>Valor <span class="math inline">\(p\)</span></strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(x_{1i}\)</span></td>
<td>0.0012</td>
</tr>
<tr class="even">
<td><span class="math inline">\(x_{2i}\)</span></td>
<td>0.0312</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(x_{3i}\)</span></td>
<td>0.0127</td>
</tr>
<tr class="even">
<td><span class="math inline">\(x_{4i}\)</span></td>
<td>0.0076</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(x_{5i}\)</span></td>
<td>0.0902</td>
</tr>
</tbody>
</table>
<p>Explique qué interpretación tienen las pruebas por el investigador B y qué se esperaría de haberse logrado una aleatorización exitosa del tratamiento?</p>
<p><em>Otra forma de proveer evidencia de la integridad del tratamiento es viendo el balance de las características observadas entre grupos de tratamiento. En este caso, si las medias entre los grupos de tratados y de control son iguales, esperaríamos que el coeficiente <span class="math inline">\(\pi\)</span> fuera no significativo. En otras palabras, <span class="math inline">\(H_0: \pi=0\)</span> en cada una de las regresiones. De nuevo, en cada caso se rechaza la hipótesis nula, lo cual indica que las características son distintas entre tratados y controles.</em></p></li>
<li><p>[5 puntos] ¿Cómo reconcilia la evidencia encontrada por sus asistentes y qué concluye sobre el balance en la asignación del tratamiento? ¿Qué características tendría una diferencia de medias de <span class="math inline">\(y_i\)</span> después del tratamiento como estimador del impacto de este?</p>
<p><em>La evidencia de las partes a. y b. es totalmente consistente entre sí. El investigador A concluye que el tratamiento se puede predecir usando las características observables, es decir, que hay carcaterísticas que hacen más probable estar en el grupo de tratados. Por su parte, el investigador B muestra que las características observables son distintas entre los grupos de tratamiento y de control. Por tanto, hay evidencia de que el experiemento estuvo comprometido y una diferencia de medias de <span class="math inline">\(y\)</span> entre tratados y controles resulta en un estimador sesgado e inconsistente del parámetro verdadero.</em></p></li>
</ol>
</div>
<div id="pregunta-2" class="section level2">
<h2>Pregunta 2</h2>
<p>Suponga que desea evaluar el impacto de las medidas de sana distancia realizadas por el gobierno de un país para reducir la mortalidad causada por el covid-19. Suponga que hubiera tenido la oportunidad implementar un experimento <strong>antes</strong> de que la epidemia se realizara.</p>
<ol style="list-style-type: lower-alpha">
<li><p>[10 puntos] Describa cómo diseñaría su experimento ideal para responder a esta pregunta.</p>
<p><em>Una posible propuesta de experimento ideal consistiría en seleccionar aleatoriamente localidades de tratamiento y control de entre las localidades consideradas como de alta marginación. En las localidades de tratamiento, a algunas familias se les asignaría de forma aleatoria a pertenecer al grupo de tratamiento, las cuales recibirían la intervención propuesta más adelante, mientras que al resto, no se les daría ningún beneficio</em></p>
<p><em>A las familias tratadas en las localidades de tratamiento se les otorgaría una transferencia de dos salarios mínimos diarios por hogar, hasta por dos meses, con el objetivo de reducir la interacción social y económica de las personas.</em></p>
<p><em>Si el propósito es evaluar el efecto de la transferencia en la tasa de fatalidad de la localidad, bastará primero con mostrar que las localidades tratadas y las de control son estadísticamente iguales en características observables.</em></p></li>
<li><p>[5 puntos] Escriba la regresión que usaría para estimar los efectos de las medidas implementadas en una variable de mortalidad.</p>
<p><em>Si el diseño permitió generar grupos estadísticamente idénticos de localidades tratadass y y de control, podemos evaluar el impacto de la intervención estimando:</em>
<span class="math display">\[y_i=\alpha+\beta T_i+X_i&#39;\Gamma+\varepsilon_i\]</span>
<em>donde <span class="math inline">\(y_i\)</span> es la tasa de fatalidad por localidad, <span class="math inline">\(T_i\)</span> es un indicador del estado de tratamiento y <span class="math inline">\(X_i\)</span> es un vector de características observables.</em></p></li>
<li><p>[5 puntos] ¿Cuáles considera que serían las distintas dificultades prácticas, institucionales y éticas en la implementación de su experimento ideal?</p>
<p><em>La evaluación propuesta permitiría identificar el efecto a nivel localidad de una política que presume que un mayor ingreso del hogar permitiría que las personas pudieran reducir su participación en el mercado de trabajo. Esta intervención resultaría fácil de implementar dado que se asignaría de forma aleatoria el beneficio y no habría ningún requisito de elegibilidad. Las mayores barreras serían las políticas y éticas. Sabemos que el distanciamiento social reduce el contagio y, por tanto, la fatalidad. Entonces, ¿cómo se puede justificar de forma ética el realizar la intervención antes descrita sobre un subgrupo de la población? Además, ¿los hogares dentro de las localidades no tratadas que no fueran asignadas al grupo de tratamiento estarán muy conformes de que su vecino reciba la trasferencia y ellos no? Esto seguramente generaría una serie de conflictos a nivel localidad, poniendo en riesgo incluso la seguridad de los individuos.</em></p>
<p><em>Noten que en esta pregunta no hay una sola respuesta correcta.</em></p></li>
</ol>
</div>
<div id="pregunta-3" class="section level2">
<h2>Pregunta 3</h2>
<p>Replique el ejercicio de representar la FEC de salarios en función de educación para México, como en la Figura 3.1.1 de MHE (p. 39), usando los datos del cuarto trimestre de 2019 de la ENOE. El gráfico es complejo, pero recibirá crédito completo si reproduce, al menos por separado, los dos siguientes tipos de gráficos:</p>
<p>Replique el ejercicio de representar la FEC de salarios en función de educación para México, como en la Figura 3.1.2 de MHE (p. 39), usando los datos del cuarto trimestre de 2019 de la ENOE. El gráfico es complejo, pero recibirá crédito completo si reproduce, al menos por separado, los dos siguientes tipos de gráficos:</p>
<ol style="list-style-type: lower-alpha">
<li><p>[10 puntos] Gráfico de la relación promedio entre años de educación e ingresos.</p>
<pre class="r"><code># FEC

data_empleo1 &lt;- read_csv(&quot;./SDEMT419.csv&quot;, locale = locale(encoding = &quot;latin1&quot;)) %&gt;% 
    clean_names()

data_socdem &lt;- read_csv(&quot;./COE1T419.csv&quot;, locale = locale(encoding = &quot;latin1&quot;)) %&gt;% 
    clean_names()

data_enoe &lt;- data_socdem %&gt;% left_join(data_empleo1, by = c(&quot;cd_a&quot;, &quot;ent&quot;, &quot;con&quot;, 
    &quot;v_sel&quot;, &quot;n_hog&quot;, &quot;h_mud&quot;, &quot;n_ren&quot;))

# Elijo quedarme con personas de más de 15 años y que se consideren parte de la
# PEA y calculo el log de losingresos semanales
data_fec &lt;- data_empleo1 %&gt;% filter(anios_esc &lt;= 20) %&gt;% filter(clase1 == 1) %&gt;% 
    mutate(ing.mensual = ingocup/4.3) %&gt;% mutate(lingreso = ifelse(ing.mensual &gt; 
    0, log(ing.mensual), NA)) %&gt;% group_by(anios_esc) %&gt;% summarize(media_lingreso = mean(lingreso, 
    na.rm = TRUE)) %&gt;% ungroup()


# FEC:
g1 &lt;- data_fec %&gt;% ggplot(aes(anios_esc, media_lingreso)) + geom_line() + labs(title = &quot;Función de esperanza condicional&quot;, 
    caption = &quot;Fuente: datos de la ENOE, T42020&quot;) + ylab(&quot;Log del ingreso semanal (MXN)&quot;) + 
    xlab(&quot;Años de educación&quot;) + scale_x_continuous(breaks = c(0, 2, 4, 6, 8, 10, 
    12, 14, 16, 18, 20))
g1</code></pre>
<p><img src="/tareas/tarea_1/tarea1_respuestas_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p></li>
<li><p>[10 puntos] Gráfico de la distribución de ingresos para cuatro niveles de educación que usted considere relevante destacar. Argumente sobre los niveles de educación elegidos.</p>
<pre class="r"><code># Densidad por grupos Con algo más de talacha podríamos superponerla sobre la FEC

data_grupos &lt;- data_empleo1 %&gt;% filter(anios_esc &lt;= 20) %&gt;% filter(clase1 == 1) %&gt;% 
    mutate(ing.mensual = ingocup/4.3) %&gt;% mutate(lingreso = ifelse(ing.mensual &gt; 
    0, log(ing.mensual), NA)) %&gt;% filter(lingreso &gt; 6 &amp; lingreso &lt; 9) %&gt;% filter(anios_esc == 
    c(6, 12, 15, 18)) %&gt;% mutate(anios_esc = factor(anios_esc))

g2 &lt;- data_grupos %&gt;% ggplot(aes(y = lingreso)) + geom_density() + facet_wrap(anios_esc ~ 
    ., nrow = 1) + labs(title = &quot;Función de densidad de salarios&quot;, subtitle = &quot;Cuatro años de educación seleccionados&quot;, 
    caption = &quot;Fuente: datos de la ENOE, T42020&quot;) + ylab(&quot;Log del ingreso semanal (MXN)&quot;) + 
    xlab(&quot;Densidad&quot;) + theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 8))
g2</code></pre>
<p><img src="/tareas/tarea_1/tarea1_respuestas_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p></li>
</ol>
</div>
<div id="pregunta-4" class="section level2">
<h2>Pregunta 4</h2>
<p>se los datos del archivo <em>STAR_public_use.csv</em> para este problema. En este problema replicará la fila correspondiente a la variable <strong>age</strong> de la Tabla 1 en <a href="https://pubs.aeaweb.org/doi/pdfplus/10.1257/app.1.1.136">Angrist et al. (2009)</a>.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<ol style="list-style-type: lower-alpha">
<li><p>[5 puntos] Obtenga la media y la desviación estándar en el grupo de control (columna 1), restringiendo la muestra a aquellos individuos con <strong>noshow</strong> igual a 0.</p>
<pre class="r"><code>data.angrist &lt;- read_csv(&quot;./STAR_public_use.csv&quot;, locale = locale(encoding = &quot;latin1&quot;)) %&gt;% 
    clean_names()

data.angrist &lt;- data.angrist %&gt;% mutate(sspany = ifelse(sfp == 1 | sfsp == 1, 1, 
    0)) %&gt;% mutate(gpa_year1 = ifelse(is.na(grade_20059_fall), NA, gpa_year1)) %&gt;% 
    mutate(grade_20059_fall = ifelse(is.na(gpa_year1), NA, grade_20059_fall)) %&gt;% 
    filter(noshow == 0)

# Estadística descriptiva

data.angrist %&gt;% summarize(media = mean(age))
## # A tibble: 1 x 1
##   media
##   &lt;dbl&gt;
## 1  18.3
data.angrist %&gt;% summarize(desvest = sd(age))
## # A tibble: 1 x 1
##   desvest
##     &lt;dbl&gt;
## 1   0.612
data.angrist %&gt;% summarize(numero = n())
## # A tibble: 1 x 1
##   numero
##    &lt;int&gt;
## 1   1571</code></pre></li>
<li><p>[10 puntos] Usando una regresión lineal, muestre que el tratamiento es independiente de la edad. De nuevo, debe restringir la muestra quienes tienen <strong>noshow</strong> igual a 0. Reporte los coeficientes y los errores estándar (columnas 2 a 4).</p>
<pre class="r"><code># Balance de características
balance &lt;- lm(age ~ ssp + sfp + sfsp, data = data.angrist)
summary(balance)$coef
##                Estimate Std. Error     t value  Pr(&gt;|t|)
## (Intercept) 18.29096639 0.01985208 921.3626622 0.0000000
## ssp         -0.05367825 0.04454083  -1.2051472 0.2283284
## sfp         -0.03276967 0.04395181  -0.7455818 0.4560319
## sfsp         0.02558038 0.05561744   0.4599344 0.6456271</code></pre></li>
<li><p>[5 puntos] Realice una prueba de significancia conjunta de los coeficientes obtenidos en el punto b. Reporte el estadístico <span class="math inline">\(F\)</span> y el valor <span class="math inline">\(p\)</span> asociado (columna 5).</p>
<pre class="r"><code># La prueba F ya está realizada con la regresión. Basta con pedirla
summary(balance)$fstatistic
##        value        numdf        dendf 
##    0.7522152    3.0000000 1567.0000000

# En la salida puedo ver p. ¿Pero cómo puedo calcularlo?
pvalue &lt;- pf(summary(balance)$fstatistic[1], summary(balance)$fstatistic[2], summary(balance)$fstatistic[3], 
    lower.tail = FALSE)
pvalue
##     value 
## 0.5210527</code></pre></li>
</ol>
</div>
<div id="pregunta-5" class="section level2">
<h2>Pregunta 5</h2>
<p>Nuevamente, use los datos del archivo <em>STAR_public_use.csv</em> para este problema. En este problema, replicará dos columnas del efecto de tratamiento de la Tabla 5. Note que de nuevo se deben usar solo las observaciones que tienen <strong>noshow</strong> igual a 0. Además, note que se usan las siguientes variables de control: <strong>sex</strong>, <strong>mtongue</strong>, <strong>hsgroup</strong>, <strong>numcourses_nov1</strong>, <strong>lastmin</strong>, <strong>mom_edn</strong>, y <strong>dad_edn</strong>, todas ellas categóricas.</p>
<p>Antes de estimar los efectos, sustituya <strong>gpa_year1</strong> por missing cuando <strong>grade_20059_fall</strong> es missing y sustituya <strong>grade_20059_fall</strong> por missing cuando <strong>gpa_year1</strong> es missing. Esto le permitirá quedarse con los individuos que tienen información completa.</p>
<ol style="list-style-type: lower-alpha">
<li><p>[10 puntos] Estime el efecto de cada tipo de tratamiento sobre el <em>GPA</em>, es decir, sobre la variable <strong>gpa_year1</strong>, para toda la muestra (Panel B, columna 1). Ponga atención a los errores estándar.</p>
<pre class="r"><code># Efecto de tratamiento

reg1 &lt;- lm(gpa_year1 ~ ssp + sfp + sfsp + factor(sex) + factor(mtongue) + factor(hsgroup) + 
    factor(numcourses_nov1) + factor(lastmin) + factor(mom_edn) + factor(dad_edn), 
    data.angrist)

# Noten que los coeficientes estimados son correctos
summary(reg1)$coef[1:4, ]
##               Estimate Std. Error  t value     Pr(&gt;|t|)
## (Intercept) 1.60138378 0.46453145 3.447310 0.0005854449
## ssp         0.07259427 0.06603498 1.099331 0.2718404422
## sfp         0.01025889 0.06515735 0.157448 0.8749178181
## sfsp        0.20971238 0.08554012 2.451626 0.0143604306

# Los errores estándar correctos son los robustos:
coeftest(reg1, vcov = vcovHC(reg1, &quot;HC1&quot;))[1:4, ]
##               Estimate Std. Error   t value     Pr(&gt;|t|)
## (Intercept) 1.60138378 0.46059228 3.4767925 0.0005252628
## ssp         0.07259427 0.06601070 1.0997349 0.2716642613
## sfp         0.01025889 0.06357889 0.1613569 0.8718389856
## sfsp        0.20971238 0.09221545 2.2741566 0.0231293441

# Finalmente, lo que se reporta en la tabla como la media del grupo de control no
# es la constante en la regresión, sino la simple media y desviación

data.angrist.reg &lt;- data.angrist %&gt;% filter(!is.na(gpa_year1) &amp; !is.na(grade_20059_fall) &amp; 
    !is.na(ssp) &amp; !is.na(sfp) &amp; !is.na(sfsp) &amp; !is.na(sex) &amp; !is.na(mtongue) &amp; !is.na(hsgroup) &amp; 
    !is.na(numcourses_nov1) &amp; !is.na(lastmin) &amp; !is.na(mom_edn) &amp; !is.na(dad_edn))

data.angrist.reg %&gt;% filter(control == 1) %&gt;% summarize(media = mean(gpa_year1, na.rm = TRUE))
## # A tibble: 1 x 1
##   media
##   &lt;dbl&gt;
## 1  1.80

data.angrist.reg %&gt;% filter(control == 1) %&gt;% summarize(desvest = sd(gpa_year1, na.rm = TRUE))
## # A tibble: 1 x 1
##   desvest
##     &lt;dbl&gt;
## 1   0.902

data.angrist.reg %&gt;% summarize(numero = n())
## # A tibble: 1 x 1
##   numero
##    &lt;int&gt;
## 1   1255</code></pre></li>
<li><p>[10 puntos] Estime el efecto de recibir cada tipo de tratamiento, considerando los tratamientos SSP o SFP (de cualquier tipo) en las mujeres de la muestra (Panel B, columna 6). Ponga atención a los errores estándar.</p>
<pre class="r"><code># Efecto de cualquier tratamiento solo en mujeres

reg2 &lt;- lm(gpa_year1 ~ ssp + sspany + factor(mtongue) + factor(hsgroup) + factor(numcourses_nov1) + 
    factor(lastmin) + factor(mom_edn) + factor(dad_edn), data = filter(data.angrist, 
    female == 1))

# Los coeficientes con los errores correctos son:
coeftest(reg2, vcov = vcovHC(reg2, &quot;HC1&quot;))[1:3, ]
##              Estimate Std. Error  t value     Pr(&gt;|t|)
## (Intercept) 2.5333972 0.28335814 8.940619 3.428412e-18
## ssp         0.1162368 0.08199976 1.417526 1.567753e-01
## sspany      0.1468443 0.07291557 2.013895 4.440376e-02</code></pre></li>
</ol>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Angrist, J., Lang, D., y Oreopoulos, P. (2009). Incentives and services for college achievement: Evidence from a randomized trial. <em>American Economic Journal: Applied Economics</em>, 1(1), 136-63.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
